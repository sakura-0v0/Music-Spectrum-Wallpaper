# Music-Spectrum-Wallpaper

A Python-based real-time audio spectrum visualization tool that converts system audio output into beautiful spectrum visualizations.

Note: For software users only, download the installation package (.exe) to install and run. Download the source code (.zip) only if you need to learn or modify the code.

'The following content was generated by AI and modified by the developer'

## Features

### Audio Processing

1. Automatically uses the system default audio device
2. Real-time capture of system audio output
3. Uniform audio resampling
4. Separate windowing and FFT for stereo channels with real-time configurable FFT parameters
5. Weighted average smoothing of results

- Automatically restarts when you change the default device or modify the device's sample rate/bit depth

### Visual Customization

- Customizable gradient colors for bars
- Free-falling peak indicators
- Particle emission effects
- Adjustable logarithmic frequency axis limits and density

### Display Modes

Right-click the system tray to configure:

- **Wallpaper Mode**: Displays spectrum on desktop wallpaper (below icons)
- **Always on Top**: Window always stays above other windows
- **Lock Window**: Like lyrics display, cannot be clicked by mouse
- **Window Size**: When enabled, allows resizing and repositioning (saves window position/size when disabled)
- **Recommended configuration combinations: (Always enable "Lock Window")**

1. Wallpaper Mode + Always on Top (Above other wallpaper software, below desktop icons - most recommended!!)
2. No options selected (Above icons, below all other windows)
3. Always on Top (Like lyrics display)

### Configuration Options

Right-click system tray, select "Options"

- Rich graphical configuration interface
- Real-time FPS monitoring
- Audio processing parameter adjustment
- Visual effects customization

### Smart Control

- Fullscreen/maximized application detection with automatic pause
- Supports auto-start on system boot
- Automatically restarts when changing default audio device or modifying sample rate/bit depth

## System Requirements

- **Operating System**: Windows 10/11
- **Python**: 3.7 (Must be 3.7!)
- **Audio**: WASAPI audio devices

## Project Setup

### 1. Install Python Dependencies

```python
pip install -r requirements.txt
```

#### Note: Do NOT directly pip install PyAudio. Install "PyAudio-0.2.11-cp37-cp37m-win_amd64.whl" from the root directory (requirements.txt)! Otherwise, system audio recording won't work!

### 2. Run Program

```python
python run.py
```



## Usage Instructions

### Basic Operations

1. After starting the program, the spectrum window appears automatically
2. Program icon displays in system tray
3. Right-click tray icon to open menu

### Configuration Interface

- Right-click tray icon, select "Options" to open configuration window
- Adjust audio processing, visual effects, and other parameters
- Some settings require restart to take effect

### Window Control

- **Lock Window**: Prevents accidental movement
- **Move Window**: Temporarily unlock for position adjustment
- **Always on Top**: Always displays in foreground
- **Wallpaper Mode**: Embeds into desktop background

### Pause Detection

- Automatically detects fullscreen/maximized applications
- Automatically pauses spectrum updates when detected (verified: 0% CPU/GPU usage when paused)
- Can add exclusion list in configuration

## Troubleshooting

### Common Issues

**Performance Issues**: Reduce target frame rate, disable particle display (CPU intensive), disable peak display (slightly CPU intensive)
**Wallpaper Mode window position offset on multi-monitor setups**: Right-click system tray, select "Wallpaper Offset" to adjust position offset, ensuring consistent window position when toggling wallpaper mode

## Development Information

### Project Structure

run.py # Main program entry
config.py # Configuration management
driver.py # Audio driver
fft_process.py # FFT processing
show.py # Display window
config_win.py # Configuration interface
check_maxsize.py # Fullscreen detection
tools.py # Utility functions

### Multi-process Architecture

- Main Process: Startup, spectrum interface
- Audio Process: Audio capture, audio resampling
- FFT Process: Separate FFT calculation and merging, FFT smoothing
- Configuration Process: Options page

## Technical Support

For issues, contact the developer:

- QQ/WeChat: 1206985031
- Developer: Huang Xiao'e